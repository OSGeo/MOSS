      SUBROUTINE VAROUT(GAMVAL)
C***
C***  THIS SUBROUTINE PRINTS THE RESULTS OF PROGRAM SS2DGAMH.
C***
      CHARACTER*4 IDSTP,HEAD,ILOG
      CHARACTER*1 D,E,BLANK,A
      INTEGER*4 NUMCUM
      DIMENSION A(50),C(6),D(20),E(13),ILOG(3),GAMVAL(5,20)
       COMMON /CHAR/ HEAD(20), IDSTP(4)
      INTEGER*4 LUP,LOW
      COMMON /xsxs/XE(5000),YN(5000),GD(5000),
     1       NUMCUM(5,20),LOG,CLAS,DLIM,ANG(5),GDBAR,VARI,
     3       STD,N,IPC,LL,SPR(5),ISCAL,TMAX,NREL,IOUT,
     4       IPCH,MAXN,NDIR,ISEL,XMIN,XMAX,YMIN,YMAX,
     5       avgdis(5,20),gammah(5,20),ctrmnt(5,20),drift(5,20),
     6       idata(5000)
      DATA ILOG/'NO','YES','YES'/, BLANK/' '/
      DATA D/5*' ','G','A','M','M','A',' ',' ','*','H','*',5*' '/
      DATA E/'M','O','M','E','N','T',' ','C','E','N','T','E','R'/
      DO 10 I=1,50
   10 A(I)=BLANK
      IF(LL.EQ.0)GO TO 30
      DO 20 I=1,13
      D(I+5)=E(I)
   20 CONTINUE
   30 C(1) = 0.
      DO 40 I=2,6
      C(I)=CLAS*4.+C(I-1)
   40 CONTINUE
C***  WRITE TABULAR RESULTS ON DISK FILE
      DO 270 L=1,NDIR
      WRITE(IOUT,50)
   50 FORMAT(' ',//,30X,'VARIOGRAM')
      WRITE(IOUT,60) IDSTP(1),IDSTP(2)
   60 FORMAT(12X,'CURRENT DATE IS  : ',2A4,5X)
      NL=logg+1
      NR=NREL+1
      WRITE(IOUT,70)HEAD
   70 FORMAT(' ',19A4,A3)
      WRITE(IOUT,80)
   80 FORMAT(54X,'DATA USED IN CACULATIONS')
      WRITE(IOUT,90) ANG(L),SPR(L),GDBAR,CLAS,VARI,DLIM,STD,ILOG(NL)
     1,ILOG(NR),N
   90 FORMAT(' DIRECTION    =',F5.0,3X,'WINDOW',F5.0,20X,'MEAN',
     110X,'=',E10.3,/' CLASS SIZE  =',F7.1,33X,'VARIANCE      =',E10.3
     2/' MAX. DISTANCE = ',F10.0,27X,'STD DEVIATION =',E10.3,
     3/ ' LOGARITHMS -',A4,5X,'RELATIVE VARIOGRAM -',A4,8X,
     4'NO.OF SAMPLES =',I7)
      IF(ISEL.NE.0)WRITE(IOUT,100)YMIN,YMAX,XMIN,XMAX
  100 FORMAT(' COORDINATE SELECTION- NORTH(',2F8.0,')',
     1 3X,'EAST(',2F8.0,')')
C***  PUNCH OUTPUT CARDS OR STORE ON DEVICE UNIT NO. 8.
C***  AS AN OPTION, CREATE DISK FILE OF VARIOGRAM DATA FOR PLOTTER.
      IF(IPC.EQ.0)GO TO 120
      WRITE(IPCH,70)IDSTP
      WRITE(IPCH,110)ANG(L),SPR(L),GDBAR,VARI,CLAS,ILOG(NL),N
  110 FORMAT(5(E10.3),A4,6X,I10)
  120 WRITE(IOUT,130)
  130 FORMAT(' ',//,4X,'DISTANCE',3X,'  PAIRS',5X,'DRIFT'
     1,5X,' GAMMA (H)',1X,'MOMENT CENT',1X,'AVER DIST')
      DO 160 I=1,20
      LOW=(I-1)*CLAS
      LUP=I*CLAS
      IF(NUMCUM(L,I).GT.0)WRITE(IOUT,150)LOW,LUP,NUMCUM(L,I),DRIFT(L,I)
     1,GAMMAH(L,I),CTRMNT(L,I),AVGDIS(L,I)
      IF((IPC.EQ.1).AND.(NUMCUM(L,I).GT.0))WRITE(IPCH,140)NUMCUM(L,I),
     1 DRIFT(L,I),GAMMAH(L,I),CTRMNT(L,I),AVGDIS(L,I)
  140 FORMAT(I10,4(E10.3))
  150 FORMAT(1H ,I6,' -',I6,I8,3(2X,E10.3),F10.2)
  160 CONTINUE
      IF(IPC.EQ.1) WRITE(IPCH,170)
  170 FORMAT(1X)
C***  WRITE GRAPHIC RESULTS ON DISK FILE.
      WRITE(IOUT,180)
      WRITE(IOUT,60)IDSTP(1),IDSTP(2)
      WRITE(IOUT,70)HEAD
      WRITE(IOUT,180)
  180 FORMAT(' ',//)
C***  IF AUTOMATIC SCALING IS NOT DESIRED, SKIP
      IF(ISCAL.EQ.0.AND.TMAX.NE.0.)GO TO 200
      TMAX=GAMVAL(L,1)
      DO 190 I=2,20
      IF(GAMVAL(L,I).GT.TMAX)TMAX=GAMVAL(L,I)
  190 CONTINUE
  200 UNIT=CLAS/2.5
      DIV=TMAX/20.
      TEMP=TMAX
      DO 240 K=1,20
       TOP=TEMP
      BOT=TEMP-DIV
      DO 210 I=1,20
      IF(NUMCUM(L,I).EQ.0)GO TO 210
      IF((GAMVAL(L,I).GT.TOP).OR.(GAMVAL(L,I).LE.BOT))GO TO 210
      J=AVGDIS(L,I)/UNIT +1
      A(J)='X'
      IF(NUMCUM(L,I).LT.30)A(J)='&'
  210 CONTINUE
C***  ARRAY CONTAINS BLANKS AS WELL AS DATA POINT MARKERS
      WRITE(IOUT,220)D(K),TEMP,A
  220 FORMAT(1H ,1X,A1,1X,E10.3,' *',50A1)
      TEMP=BOT
      DO 230 I=1,50
      A(I)=BLANK
  230 CONTINUE
  240 CONTINUE
      WRITE(IOUT,250)
  250 FORMAT(1H ,15X,5('+----+----'),'+')
      WRITE(IOUT,260)C
  260 FORMAT(1H ,10X,7(F7.0,3X))
  270 CONTINUE
      RETURN
      END
