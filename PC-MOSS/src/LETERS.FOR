        SUBROUTINE LETERS( WORDS )
CCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCC
CC
CC NAME : SUBROTUINE LETERS
CC
CC FUNCTION : TO READ IN THE POLYGON VALUES FOR THE ASSOCIATED ATTRIBUTES
CC            DATA BASE WHEN THE VALUES ARE A CHARACTER STRING.
CC
CC PARAMETERS : WORDS : ( INTEGER;INPUT ) THIS IS THE MAXIMUM NUMBER OF
CC                      CHARACTERS LONG A POLYGON CAN HAVE.
CC
CC FILES : THE USER CAN SPECIFY A FILE WHERE THE POLYGON VALUES ARE STORED.
CC         IT IS OPEN AS A SEQUENCIAL FILE.
CC
CCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCC
CC
$Include:'IO.inc'
$Include:'STRNG.inc'
          COMMON /BATAT/ IMAP(25),KMAP(25),BATCH
          COMMON/ UNIT / CHANEL, ATRBTE, POLYGON, ADRESS
CC
        DIMENSION KEY1(20)
        LOGICAL BATCH
      INTEGER CHANEL, ATRBTE, POLYGON, ADRESS, WORDS, TIMES, NAME( 10 ),
     -       COLUMN, SUBSCRT, RECORD( 128 ), KEY( 80 )
CC
CC
CC LIMIT IS THE NUMBER OF POLYGON VALUES PER RECORD
CC
            LIMIT = 128 / WORDS
            TIMES = 0
            INDEX = 1
CC
             IF(BATCH) GO TO 2001
            WRITE(NPRNT,1666)
 1666 FORMAT(' Type 1 if the  attribute values will be entered',
     1            ' in from the terminal',
     2            /' type 2 if the attribute values will be',
     3            ' read in from an external file'\)
            CALL READIN(ICARD,LENICD,ISTART,ISTOP)
            CALL INUM(ICARD,RECORD,ISTART)
            IF( RECORD( 1 ) .GT. 1 ) GO TO 3000
CC
CC THE POLYGON VALUES ARE READ IN FROM THE TERMINAL.
CC
            DO 1000 SUBSCRT = 1, POLYGON
CC
                TIMES = TIMES + 1
                WRITE(NPRNT,1001) SUBSCRT
 1001 FORMAT(' PLEASE ENTER THE CHARACTER STRING FOR FEATURE ',I4,\)
                CALL READIN( ICARD,LENICD,ISTART,ISTOP)
                DO 510 J = 1, WORDS
CC
                    RECORD( INDEX ) = ICARD( J )
                    INDEX = INDEX + 1
CC
510             CONTINUE
CC
CC
                IF( TIMES .LT. LIMIT ) GO TO 1000
CC
CC THE RECORD IS FULL MUST OUTPUT IT TO THE DATA BASE
CC
                  CALL WRBLK( CHANEL, ADRESS, RECORD, 1, IER )
                  ADRESS = ADRESS + 1
                  TIMES = 0
                  INDEX = 1
CC
1000        CONTINUE
CC
            IF( TIMES .EQ. 0 ) GO TO 2000
CC
                CALL WRBLK( CHANEL, ADRESS, RECORD, 1, IER )
                ADRESS = ADRESS + 1
CC
2000        CONTINUE
                RETURN
CC
CC
CC THE POLYGON VALUES ARE READ IN FROM AN EXTERNAL FILE. THE USER MUST
CC TYPE IN THE NAME OF THE FILE.
CC
3000        CONTINUE
             write(NPRNT,1111)
1111         FORMAT( ' TYPE IN THE NAME OF THE FILE. '\)
             CALL READIN( ICARD,LENICD,ISTART,istop)
             CALL DECIP( ICARD, RECORD, ISTART )
             CALL PACKC( RECORD, NAME, 10 )
             CALL OPENF(51,NAME,1,0,0,IER)
             IF(IER.NE.0)GO TO 4500
C
        write(*,9898)
9898    format(' ENTER INPUT FORMAT '\)
 2001   CONTINUE
        CALL READIN(ICARD,40,ISTART,ISTOP)
        CALL PACKC(ICARD,KEY1,40)
C       WRITE(NPRNT,3011) (KEY1(II),II=1,20)
C 3011  FORMAT(' *LETERS* KEY',20A2)
CC
             IF(.NOT.BATCH) IOIN = 5
             LENGTH = WORDS
CC
CC READ IN THE POLYGON VALUES.
CC
             DO 4000 SUBSCRT = 1, POLYGON
CC
                TIMES = TIMES + 1
                READ(51,KEY1,ERR=4510) (ICARD(II),II=1,WORDS)
          DO 234 II=1,WORDS
       IF(ICARD(II).GT.256)ICARD(II)=ICARD(II)-8192
       if(ICARD(ii).GT.96.AND.ICARD(ii).LT.123)ICARD(ii)=ICARD(ii)-32
 234      CONTINUE
                KLL=73
  244           KLL=KLL-1
                IF(KLL.LE.0) GO TO 245
                IF(ICARD(KLL).NE.32) GO TO 245
                ICARD(KLL)=0
                GO TO 244
 245    CONTINUE
                LOCATE = 1
                DO 3900 COLUMN = INDEX, LENGTH
                  RECORD( COLUMN ) = ICARD( LOCATE )
                  LOCATE = LOCATE + 1
3900            CONTINUE
                INDEX = LENGTH + 1
                LENGTH = INDEX + WORDS - 1
CC
                IF( TIMES .LT. LIMIT ) GO TO 4000
CC
                CALL WRBLK( CHANEL, ADRESS, RECORD, 1, IER )
                LENGTH = WORDS
                ADRESS = ADRESS + 1
                TIMES = 0
                INDEX = 1
CC
4000         CONTINUE
CC
              IF(.NOT.BATCH) IOIN=5
             IF( TIMES .EQ. 0 ) GO TO 4200
             CALL WRBLK( CHANEL, ADRESS, RECORD, 1, IER )
             ADRESS = ADRESS + 1
CC
4200         CONTINUE
                IF(.NOT.BATCH) CLOSE(51,IOSTAT=IER)
                RETURN
CC
4500         CONTINUE
      WRITE(NPRNT,4501) IER
 4501 FORMAT(' THE ATTRIBUTE DATA FILE DID NOT OPEN CORECTLY  ERROR',I5)
                RETURN
4510     CONTINUE
                WRITE(NPRNT,4515) IER
 4515 FORMAT(' *LETERS* ERROR READING ATRIBUTES INPUT FILE ERROR',I5)
                RETURN
                END
