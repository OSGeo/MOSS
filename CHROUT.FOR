        SUBROUTINE CHROUT( LOCATE, WORDS )
CCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCC
CC
CC NAME : SUBROUTINE CHROUT
CC
CC FUNCTION : TO LIST OUT THE ENTIRE OR SPECIFIED POLYGON VALUES OF AN
CC            SPECIFIED ATTRIBUTE. THE POLYGON VALUES MUST BE OF DATA
CC            TYPE CHARACTER.
CC
CC PARAMETERS : LOCATE :( INTEGER;INPUT ) THE ADDRESS LOCATION IN THE
CC                        DATA BASE WHERE THE FIRST RECORD CONTAIN THE
CC                        POLYGON VALUES ARE STORED.
CC              WORDS : ( INTEGER;INPUT ) THE MAXIMUM NUMBER OF CHARACTERS
CC                      ANY ONE POLYGON VALUE CAN BE.
CC
CC
CC ROTUINES REQUIRED : SUBROUTINE RDBLK, SUBROUTINE READIN
CC
CC*****************************************************************
$Include:'IO.inc'
$Include:'STRNG.inc'
$Include:'WORK.inc'
      common/STATIK/ TIMES,LOCT,WRDS
      COMMON /PNTFET/ NPOINT
CC
      COMMON /SERIT/ JSERCH,COUNT,KALL,HITS,DPOINT,ICHANP
      COMMON/ UNIT / CHANEL, ATRBTE, POLYGON, ADRESS
CC
      INTEGER DPOINT,WRDS,INK(2,20)
      INTEGER CHANEL, ATRBTE, POLYGON, ADRESS, COUNT, TIMES,
     1 WORDS, BUFER(128), ACTION, UPPER,HITS
CC
CC LENGTH IS THE NUMBER OF POLYGON VALUES PER RECORD.
CC
       LENGTH = 128 / WORDS
       WRDS=WORDS
       LOCT=LOCATE
CC LIMIT IS THE NUMBER OF POLYGON VALUES IN A PARTICULAR RECORD
CC
       LIMIT = LENGTH
       COUNT = 1
       LOWER = 1
       UPPER = WORDS
       HITS = 0
CC
       WRITE(NPRNT,1001)
 1001  FORMAT(' ENTER 1 FOR OBTAINING ALL ITEMS',
     1       /' ENTER 2 FOR BOUNDED SEARCH '\)
       CALL READIN(ICARD,LENICD,ISTART,istop)
       CALL INUM(ICARD,ACTION,ISTART)
CC
       IF( ACTION .GT. 1 ) GO TO 2000
CC
CC
CC WRITING OUT THE ENTIRE POLYGON LIST TO THE SPECIFIED ATTRIBUTE.
CC
        KALL=0
        IF(JSERCH.EQ.1) KALL=1
        IF(KALL.EQ.1) RETURN
        DO 1000 INDEX = 1, POLYGON, LENGTH
CC
        IF( INDEX + LENGTH - 1 .GT. POLYGON )
     1  LIMIT = POLYGON - INDEX + 1
        CALL RDBLK( CHANEL, LOCATE, BUFER, 1, IER )
CC
        DO 500 TIMES = 1, LIMIT
CC
        IF(JSERCH.EQ.0) WRITE(NPRNT,200) COUNT,
     1  (bufer(i),i= LOWER,UPPER)
200   FORMAT( 9H POLYGON , I5,
     1 ' THE CHARACTER STRING IS :', 2X, 22a1, /,1X ,50a1)
         LOWER = LOWER + WORDS
         UPPER = LOWER + WORDS - 1
         COUNT = COUNT + 1
CC
  500  CONTINUE
       LOWER = 1
       UPPER = WORDS
       LOCATE = LOCATE + 1
CC
1000   CONTINUE
        RETURN
CC
2000      CONTINUE
CC THE USER WANTES ONLY POLYGONS WITH A CERTAIN CHARACTER STRING VALUE
CC WRITTEN OUT.
CC
CC
      WRITE(nprnt,1050)
 1050 FORMAT(' TYPE IN THE CHARACTER STRING OF INTEREST',/,
     +       ' SEPARATE MULTIPLE STRINGS WITH A <!>'\)
      CALL READIN( ICARD,LENICD,ISTART,istop )
C
C  BACKUP CHARACTER POINTER TO DETERMINE NUMBER OF WORDS IN STRING
C
      LWORDS=73
 4001 LWORDS=LWORDS-1
      IF(LWORDS.EQ.0) RETURN
      IF(ICARD(LWORDS).EQ.0  .OR.  ICARD(LWORDS) .EQ. 32  .OR.
     1 ICARD(LWORDS) .EQ. 33) GO TO 4001
C
CC   FIND OUT IF THEY PUT IN MULTIPLE SEARCHES
C
       KNT = 1
       INK(2,KNT)=LWORDS
       I=ISTART
       IF (ICARD(I) .EQ. 33) I= I + 1
       INK(1,KNT)=I
       DO 2020 JK=I,LWORDS
         IF(ICARD(JK) .EQ. 33) INK(2,KNT)=JK-1
         IF(ICARD(JK) .EQ. 33) KNT=KNT+1
         IF(ICARD(JK) .EQ. 33) INK(1,KNT)=JK+1
 2020  CONTINUE
       INK(2,KNT) = LWORDS
C
CC SEARCHING THE ENTIRE POLYGON LIST FOR THE CHARACTER STRING VALUE.
CC
        KALL=0
        DO 4000 INDEX = 1, POLYGON, LENGTH
        NUMBER = 1
        LOWER = 1
        IF( INDEX + LENGTH - 1 .GT. POLYGON ) LIMIT=POLYGON-INDEX+1
        CALL RDBLK( CHANEL, LOCT, BUFER, 1, IER )
CC
        DO 2500 TIMES = 1, LIMIT
        IF(JSERCH.EQ.1) CALL RDBLK(ICHANP,DPOINT,IBUFF,1,IER)
C
C  REMOVE PRECEEDING BLANKS
C
       I = 0
       DO 2220 JK=1,WRDS
         IF(BUFER(NUMBER+I).GT.32) GO TO 2225
         I=I+1
 2220  CONTINUE
 2225  CONTINUE
C
C  FIND A MATCH
C
       DO 2230 JKL=1,KNT
         DO 2228 JK=INK(1,JKL),INK(2,JKL)
           IF(BUFER(NUMBER+I).NE.ICARD(JK)) GO TO 2230
           I = I + 1
 2228    CONTINUE
CC  GOT ONE
       GO TO 2240
 2230  CONTINUE
       GO TO 2300
CC
CC THERE WAS A MATCH
CC
 2240  CONTINUE
                  HITS = HITS + 1
        IF(JSERCH.ne.1) then
           WRITE(NPRNT,200) COUNT,(BUFER(I),I=NUMBER,NUMBER+WRDS-1)
           GO TO 2300
        else
c  jsearch=1
           npoint=npoint+1
           if(npoint.gt.32500)then
              write(nprnt,1111) NPOINT
1111          FORMAT( ' Feature file almost full :')
           endif
           CALL putfast(npoint,ibuff(15),dpoint,ibuff(24),
     +                  dpoint,dpoint,ier)
        endif
CC
2300   CONTINUE
       IF (JSERCH .EQ. 1) DPOINT=IBUFF(1)
       NUMBER = LOWER + WRDS
       LOWER = NUMBER
       COUNT = COUNT + 1
2500   CONTINUE
CC
       LOCT = LOCT + 1
CC
4000   CONTINUE
CC
        IF(JSERCH.EQ.0) WRITE(NPRNT,1002)HITS
 1002    FORMAT(' THERE ARE ',I5,' ITEMS WITH THIS STRING')
             RETURN
             END
